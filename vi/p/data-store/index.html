<!doctype html><html lang=vi dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="DataStore được tạo ra chính là để thay thế SharedPreferences lưu trữ những dữ liệu đơn giản."><title>DataStore - mảnh ghép hoàn hảo cho bức tranh Kotlin Coroutines</title><link rel=canonical href=https://namanh11611.github.io/vi/p/data-store/><link rel=stylesheet href=/scss/style.min.833d6eed45de56f48306bf57268d5b8cdfc8a60e8e7bdc99810464fcd033f7c6.css><meta property='og:title' content="DataStore - mảnh ghép hoàn hảo cho bức tranh Kotlin Coroutines"><meta property='og:description' content="DataStore được tạo ra chính là để thay thế SharedPreferences lưu trữ những dữ liệu đơn giản."><meta property='og:url' content='https://namanh11611.github.io/vi/p/data-store/'><meta property='og:site_name' content='Henry Techie'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Kotlin'><meta property='article:tag' content='Android'><meta property='article:tag' content='Data Store'><meta property='article:published_time' content='2023-05-14T15:41:00+07:00'><meta property='article:modified_time' content='2023-05-14T15:41:00+07:00'><meta property='og:image' content='https://namanh11611.github.io/p/data-store/datastore.webp'><meta name=twitter:title content="DataStore - mảnh ghép hoàn hảo cho bức tranh Kotlin Coroutines"><meta name=twitter:description content="DataStore được tạo ra chính là để thay thế SharedPreferences lưu trữ những dữ liệu đơn giản."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://namanh11611.github.io/p/data-store/datastore.webp'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Hiển thị Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/vi/><img src=/img/avatar_hu_99416cdbb1f5ed1b.webp width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/vi>Henry Techie</a></h1><h2 class=site-description>Software Engineer</h2></div></header><ol class=menu-social><li><a href=https://linkedin.com/in/namanh11611 target=_blank title=LinkedIn rel=me><svg class="icon icon-tabler icon-tabler-brand-linkedin" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a href=https://github.com/namanh11611 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://viblo.asia/u/namanh11611 target=_blank title=Viblo rel=me><svg class="icon icon-tabler icon-tabler-letter-v" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 4l6 16 6-16"/></svg></a></li><li><a href=https://twitter.com/namanh11611 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li><li><a href=https://facebook.com/namanh11611 target=_blank title=Facebook rel=me><svg class="icon icon-tabler icon-tabler-brand-facebook" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 10v4h3v7h4v-7h3l1-4h-4V8a1 1 0 011-1h3V3h-3a5 5 0 00-5 5v2H7"/></svg></a></li></ol><ol class=menu id=main-menu><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://namanh11611.github.io/>English</option><option value=https://namanh11611.github.io/vi/ selected>Tiếng Việt</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Chế độ nền tối</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Mục lục</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#concept>Concept</a></li><li><a href=#preferences-datastore>Preferences DataStore</a><ol><li><a href=#create>Create</a></li><li><a href=#read>Read</a></li><li><a href=#write>Write</a></li></ol></li><li><a href=#proto-datastore>Proto DataStore</a><ol><li><a href=#protocol-buffers>Protocol buffers</a></li><li><a href=#create-1>Create</a></li><li><a href=#read-1>Read</a></li><li><a href=#write-1>Write</a></li></ol></li><li><a href=#so-sánh-với-sharedpreferences>So sánh với SharedPreferences</a><ol><li><a href=#migrate-from-sharedpreferences-to-preferences-datastore>Migrate from SharedPreferences to Preferences DataStore</a></li><li><a href=#migrate-from-sharedpreferences-to-proto-datastore>Migrate from SharedPreferences to Proto DataStore</a></li></ol></li><li><a href=#references>References</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/vi/p/data-store/><img src=/p/data-store/datastore_hu_ce2e2684677ce11c.webp srcset="/p/data-store/datastore_hu_ce2e2684677ce11c.webp 800w, /p/data-store/datastore_hu_c3bb0108759eda1f.webp 1600w" width=800 height=533 loading=lazy alt="Featured image of post DataStore - mảnh ghép hoàn hảo cho bức tranh Kotlin Coroutines"></a></div><div class=article-details><header class=article-category><a href=/vi/categories/technical/ style=background-color:#e60f41;color:#fff>Technical
</a><a href=/vi/categories/android/ style=background-color:#048665;color:#fff>Android</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/vi/p/data-store/>DataStore - mảnh ghép hoàn hảo cho bức tranh Kotlin Coroutines</a></h2><h3 class=article-subtitle>DataStore được tạo ra chính là để thay thế SharedPreferences lưu trữ những dữ liệu đơn giản.</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2023-05-14T15:41:00+07:00>thg 5 14, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>6 phút đọc</time></div></footer><footer class=article-translations><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><div><a href=https://namanh11611.github.io/p/data-store/ class=link>English</a></div></footer></div></header><section class=article-content><h1 id=concept>Concept</h1><p>Trước hết, chúng ta cần hiểu <strong>DataStore</strong> sinh ra với mục đích là gì.</p><p>Hiện tại, trong ứng dụng Android, chúng ta có 5 cách để lưu trữ dữ liệu, trong đó <strong>SharedPreferences</strong> là cách dùng để lưu những dữ liệu đơn giản nhất. Nó chỉ gồm <strong>key</strong> và <strong>value</strong>, trong đó value có thể là integer, string&mldr;</p><p><img src=/p/data-store/storage.webp width=578 height=353 srcset="/p/data-store/storage_hu_f94ca52d4914c5.webp 480w, /p/data-store/storage_hu_8b50fe63762bb46c.webp 1024w" loading=lazy alt=Storage class=gallery-image data-flex-grow=163 data-flex-basis=392px></p><p>Khi lần đầu mở app, nó sẽ đọc toàn bộ giá trị trong file xml của SharedPreferences và lưu vào RAM. Quá trình đọc file này lại diễn ra trên <strong>UI Thread</strong>, nếu chúng ta có rất rất nhiều giá trị khiến cho thời gian thực hiện tác vụ vượt quá 5 giây, nó sẽ gây ra lỗi <strong>ANR</strong> (Application Not Responding).</p><p>Và <strong>DataStore</strong> được tạo ra chính là để thay thế <strong>SharedPreferences</strong>.</p><blockquote><p>DataStore là giải pháp lưu trữ dữ liệu theo dạng <strong>cặp key-value</strong> hoặc <strong>typed objects với protocol buffers</strong>.</p></blockquote><p>Tất nhiên, DataStore vẫn chỉ dành để lưu những dữ liệu có cấu trúc đơn giản. Nó sử dụng Coroutines và Flow để lưu data một cách bất đồng bộ và nhất quán.</p><p>DataStore gồm 2 loại <strong>Preferences DataStore</strong> và <strong>Proto DataStore</strong>, chúng ta cùng nhìn qua bảng so sánh sau:</p><div class=table-wrapper><table><thead><tr><th>Preferences DataStore</th><th>Proto DataStore</th></tr></thead><tbody><tr><td>Lưu và truy cập data bằng key</td><td>Lưu instance của một loại custom data</td></tr><tr><td>Không yêu cầu định nghĩa trước loại data</td><td>Phải định nghĩa trước loại data bằng protocol buffers</td></tr><tr><td>Không có type safety</td><td>Có type safety</td></tr></tbody></table></div><h1 id=preferences-datastore>Preferences DataStore</h1><h2 id=create>Create</h2><p>Để sử dụng Preferences DataStore, chúng ta cần tạo một instance <code>DataStore&lt;Preferences></code> bằng <a class=link href=../design-pattern-delegation>property delegate</a> với keyword <code>preferencesDataStore</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=c1>// At the top level of your kotlin file
</span></span></span><span class=line><span class=cl><span class=k>val</span> <span class=py>Context</span><span class=p>.</span><span class=n>dataStore</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>&lt;</span><span class=n>Preferences</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=k>by</span> <span class=n>preferencesDataStore</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;settings&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=read>Read</h2><p>Trước hết, chúng ta có 7 function tương ứng với 7 loại data:</p><ul><li><code>intPreferencesKey()</code></li><li><code>longPreferencesKey()</code></li><li><code>doublePreferencesKey()</code></li><li><code>floatPreferencesKey()</code></li><li><code>booleanPreferencesKey()</code></li><li><code>stringPreferencesKey()</code></li><li><code>stringSetPreferencesKey()</code></li></ul><p>Khi đọc data, chúng ta cần dùng function tương ứng với giá trị mà chúng ta cần lưu. Ví dụ để lưu một biến <code>counter</code> dạng số nguyên để đếm số lần user mở app, chúng ta có thể dùng cách sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>val</span> <span class=py>OPEN</span><span class=n>_APP_COUNTER</span> <span class=p>=</span> <span class=n>intPreferencesKey</span><span class=p>(</span><span class=s2>&#34;open_app_counter&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>val</span> <span class=py>openAppCounterFlow</span><span class=p>:</span> <span class=n>Flow</span><span class=p>&lt;</span><span class=n>Int</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>context</span><span class=p>.</span><span class=n>dataStore</span><span class=p>.</span><span class=k>data</span>
</span></span><span class=line><span class=cl>  	<span class=p>.</span><span class=n>map</span> <span class=p>{</span> <span class=n>preferences</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    	<span class=c1>// No type safety.
</span></span></span><span class=line><span class=cl>    	<span class=n>preferences</span><span class=p>[</span><span class=n>OPEN_APP_COUNTER</span><span class=p>]</span> <span class=o>?:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Điểm khác biệt với SharedPreferences chính là ở đây, data được trả về dưới dạng Flow. Giờ đây, các layer phía trên như Repository có thể observe data một cách thống nhất, không cần quan tâm nó đến từ DataStore, Room database hay Server, bởi vì tất cả đều được return dưới dạng Flow.</p><h2 id=write>Write</h2><p>Để ghi dữ liệu, chúng ta dùng function <code>edit</code>, cũng khá giống với SharedPreferences.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=n>context</span><span class=p>.</span><span class=n>dataStore</span><span class=p>.</span><span class=n>edit</span> <span class=p>{</span> <span class=n>settings</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>openAppCounterValue</span> <span class=p>=</span> <span class=n>settings</span><span class=p>[</span><span class=n>OPEN_APP_COUNTER</span><span class=p>]</span> <span class=o>?:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>settings</span><span class=p>[</span><span class=n>OPEN_APP_COUNTER</span><span class=p>]</span> <span class=p>=</span> <span class=n>openAppCounterValue</span> <span class=p>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=proto-datastore>Proto DataStore</h1><p>Trước khi tìm hiểu về Proto DataStore, chúng ta cần dạo qua một vòng về protocol buffers.</p><h2 id=protocol-buffers>Protocol buffers</h2><p>Đây là một một kiểu định dạng dữ liệu mà không phụ thuộc vào ngôn ngữ lập trình hay platform. Nó giống như JSON nhưng nhỏ và nhanh hơn nhiều lần. Protocol buffers cũng được giới thiệu là định dạng dữ liệu được sử dụng phổ biến nhất tại Google.</p><ul><li>Nó dùng để lưu các dữ liệu nhỏ gọn</li><li>Phân tích cú pháp nhanh</li><li>Hỗ trợ nhiều ngôn ngữ lập trình như C++, C#, Dart, Go, Java, Kotlin, Python</li><li>Tối ưu hoá chức năng thông qua các class được generate tự động</li></ul><p>Ví dụ một <code>message</code> về thông tin user gồm tên, id và email:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-protobuf data-lang=protobuf><span class=line><span class=cl><span class=kd>message</span> <span class=nc>UserProfile</span> <span class=p>{</span><span class=err>
</span></span></span><span class=line><span class=cl>  <span class=k>optional</span> <span class=kt>string</span> <span class=n>name</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl>  <span class=k>optional</span> <span class=kt>int32</span> <span class=n>id</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl>  <span class=k>optional</span> <span class=kt>string</span> <span class=n>email</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>Để so sánh về hiệu năng so của Protocol buffers so với JSON, chúng ta thử gọi 500 <code>GET</code> requests từ một app Spring Boot này tới app Spring Boot khác với 2 môi trường có nén và không nén data. Và đây là kết quả:</p><p><img src=/p/data-store/protobuf.webp width=825 height=433 srcset="/p/data-store/protobuf_hu_4332fd8adb139fd2.webp 480w, /p/data-store/protobuf_hu_ebd847d8d0f6234f.webp 1024w" loading=lazy alt=Protobuf class=gallery-image data-flex-grow=190 data-flex-basis=457px></p><p>Chúng ta có thể thấy Protocol buffer <strong>nhanh hơn từ 5 đến 6 lần</strong> so với JSON.</p><h2 id=create-1>Create</h2><p>Để sử dụng Proto DataStore, chúng ta phải định nghĩa loại data bằng một file proto <code>settings.pb</code> trong folder <code>app/src/main/proto/</code> như sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-protobuf data-lang=protobuf><span class=line><span class=cl><span class=n>syntax</span> <span class=o>=</span> <span class=s>&#34;proto3&#34;</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=k>option</span> <span class=n>java_package</span> <span class=o>=</span> <span class=s>&#34;com.example.application&#34;</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=k>option</span> <span class=n>java_multiple_files</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=kd>message</span> <span class=nc>Settings</span> <span class=p>{</span><span class=err>
</span></span></span><span class=line><span class=cl>  	<span class=kt>int32</span> <span class=n>open_app_counter</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>Sau đó, tiếp tục khai báo một object implement class <code>Serializer&lt;T></code> với <code>T</code> là kiểu dữ liệu đã được định nghĩa trong proto file.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>object</span> <span class=nc>SettingsSerializer</span> <span class=p>:</span> <span class=n>Serializer</span><span class=p>&lt;</span><span class=n>Settings</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>override</span> <span class=k>val</span> <span class=py>defaultValue</span><span class=p>:</span> <span class=n>Settings</span> <span class=p>=</span> <span class=nc>Settings</span><span class=p>.</span><span class=n>getDefaultInstance</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>override</span> <span class=k>suspend</span> <span class=k>fun</span> <span class=nf>readFrom</span><span class=p>(</span><span class=n>input</span><span class=p>:</span> <span class=n>InputStream</span><span class=p>):</span> <span class=n>Settings</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nc>Settings</span><span class=p>.</span><span class=n>parseFrom</span><span class=p>(</span><span class=n>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=n>exception</span><span class=p>:</span> <span class=n>InvalidProtocolBufferException</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=n>CorruptionException</span><span class=p>(</span><span class=s2>&#34;Cannot read proto.&#34;</span><span class=p>,</span> <span class=n>exception</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>override</span> <span class=k>suspend</span> <span class=k>fun</span> <span class=nf>writeTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span><span class=p>:</span> <span class=n>Settings</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>output</span><span class=p>:</span> <span class=n>OutputStream</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span> <span class=p>=</span> <span class=n>t</span><span class=p>.</span><span class=n>writeTo</span><span class=p>(</span><span class=n>output</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Và cuối cùng là sử dụng <a class=link href=../design-pattern-delegation>property delegate</a> với keyword <code>dataStore</code> để tạo một instance của <code>DataStore&lt;T></code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>val</span> <span class=py>Context</span><span class=p>.</span><span class=n>settingsDataStore</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>&lt;</span><span class=n>Settings</span><span class=p>&gt;</span> <span class=k>by</span> <span class=n>dataStore</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>fileName</span> <span class=p>=</span> <span class=s2>&#34;settings.pb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>serializer</span> <span class=p>=</span> <span class=n>SettingsSerializer</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=read-1>Read</h2><p>Tương tự như Preferences DataStore, chúng ta cũng dùng <code>DataStore.data</code> để trả về một Flow.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>val</span> <span class=py>openAppCounterFlow</span><span class=p>:</span> <span class=n>Flow</span><span class=p>&lt;</span><span class=n>Int</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>context</span><span class=p>.</span><span class=n>settingDataStore</span><span class=p>.</span><span class=k>data</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=n>map</span> <span class=p>{</span> <span class=n>settings</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// The openAppCounter is generated from the proto schema.
</span></span></span><span class=line><span class=cl>    <span class=n>settings</span><span class=p>.</span><span class=n>openAppCounter</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=write-1>Write</h2><p>Để ghi data vào Proto DataStore, chúng ta có function <code>updateData()</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=n>context</span><span class=p>.</span><span class=n>settingsDataStore</span><span class=p>.</span><span class=n>updateData</span> <span class=p>{</span> <span class=n>currentSettings</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>  <span class=n>currentSettings</span><span class=p>.</span><span class=n>toBuilder</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>setExampleCounter</span><span class=p>(</span><span class=n>currentSettings</span><span class=p>.</span><span class=n>exampleCounter</span> <span class=p>+</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>build</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=so-sánh-với-sharedpreferences>So sánh với SharedPreferences</h1><p><img src=/p/data-store/comparison.webp width=825 height=710 srcset="/p/data-store/comparison_hu_479fa0e159e3b68f.webp 480w, /p/data-store/comparison_hu_c35555bda153f02.webp 1024w" loading=lazy alt=Comparison class=gallery-image data-flex-grow=116 data-flex-basis=278px></p><h2 id=migrate-from-sharedpreferences-to-preferences-datastore>Migrate from SharedPreferences to Preferences DataStore</h2><p>Để migrate, chúng ta truyền <code>SharedPreferencesMigration</code> vào param <code>produceMigrations</code>. DataStore sẽ tự động migrate cho chúng ta.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>val</span> <span class=py>Context</span><span class=p>.</span><span class=n>dataStore</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>&lt;</span><span class=n>Preferences</span><span class=p>&gt;</span> <span class=k>by</span> <span class=n>preferencesDataStore</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span> <span class=p>=</span> <span class=n>DATA_STORE_NAME</span>
</span></span><span class=line><span class=cl>  <span class=n>produceMigrations</span> <span class=p>=</span> <span class=p>{</span> <span class=n>context</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>listOf</span><span class=p>(</span><span class=n>SharedPreferencesMigration</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>context</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>SHARED_PREFERENCES_NAME</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=migrate-from-sharedpreferences-to-proto-datastore>Migrate from SharedPreferences to Proto DataStore</h2><p>Trước tiên, chúng ta cần khai báo <code>UserProfile</code> và <code>UserProfileSerializer</code> tương tự như các bước ở trên. Sau đó viết một mapping function để migrate từ cặp key-value trong SharedPreferences sang loại dữ liệu trong Proto DataStore.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>val</span> <span class=py>Context</span><span class=p>.</span><span class=n>dataStore</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>&lt;</span><span class=n>UserProfile</span><span class=p>&gt;</span> <span class=k>by</span> <span class=n>dataStore</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>fileName</span> <span class=p>=</span> <span class=s2>&#34;settings.pb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>serializer</span> <span class=p>=</span> <span class=n>UserProfileSerializer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>produceMigrations</span> <span class=p>=</span> <span class=p>{</span> <span class=n>context</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>listOf</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>SharedPreferencesMigration</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>context</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;settings_pref&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>)</span> <span class=p>{</span> <span class=n>prefs</span><span class=p>:</span> <span class=n>SharedPreferencesView</span><span class=p>,</span> <span class=n>user</span><span class=p>:</span> <span class=n>UserProfile</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span><span class=p>.</span><span class=n>toBuilder</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>setName</span><span class=p>(</span><span class=n>prefs</span><span class=p>.</span><span class=n>getString</span><span class=p>(</span><span class=n>NAME_KEY</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>setId</span><span class=p>(</span><span class=n>prefs</span><span class=p>.</span><span class=n>getInt</span><span class=p>(</span><span class=n>ID_KEY</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>setEmail</span><span class=p>(</span><span class=n>prefs</span><span class=p>.</span><span class=n>getString</span><span class=p>(</span><span class=n>EMAIL_KEY</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>build</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=references>References</h1><ul><li><a class=link href=https://developer.android.com/topic/libraries/architecture/datastore target=_blank rel=noopener>https://developer.android.com/topic/libraries/architecture/datastore</a></li><li><a class=link href=https://protobuf.dev/programming-guides/proto3 target=_blank rel=noopener>https://protobuf.dev/programming-guides/proto3</a></li><li><a class=link href=https://android-developers.googleblog.com/2020/09/prefer-storing-data-with-jetpack.html target=_blank rel=noopener>https://android-developers.googleblog.com/2020/09/prefer-storing-data-with-jetpack.html</a></li><li><a class=link href=https://stackoverflow.com/questions/9986734/which-android-data-storage-technique-to-use target=_blank rel=noopener>https://stackoverflow.com/questions/9986734/which-android-data-storage-technique-to-use</a></li><li><a class=link href=https://auth0.com/blog/beating-json-performance-with-protobuf target=_blank rel=noopener>https://auth0.com/blog/beating-json-performance-with-protobuf</a></li><li><a class=link href=https://proandroiddev.com/is-jetpack-datastore-a-replacement-for-sharedpreferences-efe92d02fcb3 target=_blank rel=noopener>https://proandroiddev.com/is-jetpack-datastore-a-replacement-for-sharedpreferences-efe92d02fcb3</a></li><li><a class=link href=https://kinya.hashnode.dev/migrating-sharedpreferences-to-datastore-ckxzlvda101by8rs1c8bg4wdx target=_blank rel=noopener>https://kinya.hashnode.dev/migrating-sharedpreferences-to-datastore-ckxzlvda101by8rs1c8bg4wdx</a></li><li><a class=link href=https://amitshekhar.me/blog/jetpack-datastore-preferences target=_blank rel=noopener>https://amitshekhar.me/blog/jetpack-datastore-preferences</a></li></ul></section><footer class=article-footer><section class=article-tags><a href=/vi/tags/kotlin/>Kotlin</a>
<a href=/vi/tags/android/>Android</a>
<a href=/vi/tags/data-store/>Data Store</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Bài viết liên quan</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/vi/p/kotlin-flow-cheat-sheet-3/><div class=article-image><img src=/p/kotlin-flow-cheat-sheet-3/cheat_sheet.693580b63998c07c78483b5a2f6bbda9_hu_e378eacd4945636.webp width=250 height=150 loading=lazy alt="Featured image of post Kotlin Flow cheat sheet phần 3: SharedFlow và StateFlow" data-key=kotlin-flow-cheat-sheet-3 data-hash="md5-aTWAtjmYwHx4SDtaL2u9qQ=="></div><div class=article-details><h2 class=article-title>Kotlin Flow cheat sheet phần 3: SharedFlow và StateFlow</h2></div></a></article><article class=has-image><a href=/vi/p/kotlin-flow-cheat-sheet-2/><div class=article-image><img src=/p/kotlin-flow-cheat-sheet-2/cheat_sheet.693580b63998c07c78483b5a2f6bbda9_hu_e378eacd4945636.webp width=250 height=150 loading=lazy alt="Featured image of post Kotlin Flow cheat sheet phần 2: Flow" data-key=kotlin-flow-cheat-sheet-2 data-hash="md5-aTWAtjmYwHx4SDtaL2u9qQ=="></div><div class=article-details><h2 class=article-title>Kotlin Flow cheat sheet phần 2: Flow</h2></div></a></article><article class=has-image><a href=/vi/p/kotlin-flow-cheat-sheet-1/><div class=article-image><img src=/p/kotlin-flow-cheat-sheet-1/cheat_sheet.693580b63998c07c78483b5a2f6bbda9_hu_e378eacd4945636.webp width=250 height=150 loading=lazy alt="Featured image of post Kotlin Flow cheat sheet phần 1: Channel" data-key=kotlin-flow-cheat-sheet-1 data-hash="md5-aTWAtjmYwHx4SDtaL2u9qQ=="></div><div class=article-details><h2 class=article-title>Kotlin Flow cheat sheet phần 1: Channel</h2></div></a></article><article class=has-image><a href=/vi/p/kotlin-coroutines-cheat-sheet/><div class=article-image><img src=/p/kotlin-coroutines-cheat-sheet/cheat_sheet.693580b63998c07c78483b5a2f6bbda9_hu_e378eacd4945636.webp width=250 height=150 loading=lazy alt="Featured image of post Kotlin Coroutines cheat sheet nâng cao dành cho Android Engineer" data-key=kotlin-coroutines-cheat-sheet data-hash="md5-aTWAtjmYwHx4SDtaL2u9qQ=="></div><div class=article-details><h2 class=article-title>Kotlin Coroutines cheat sheet nâng cao dành cho Android Engineer</h2></div></a></article><article class=has-image><a href=/vi/p/kotlin-multiplatform/><div class=article-image><img src=/p/kotlin-multiplatform/kotlin.e43e1e5bec35304b717a84e01f915467_hu_201fbaf4661397cf.webp width=250 height=150 loading=lazy alt="Featured image of post Kotlin Multiplatform - Kẻ ngáng đường Flutter, React Native?" data-key=kotlin-multiplatform data-hash="md5-5D4eW+w1MEtxeoTgH5FUZw=="></div><div class=article-details><h2 class=article-title>Kotlin Multiplatform - Kẻ ngáng đường Flutter, React Native?</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//henry-techie.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2019 -
2026 Henry Techie</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> thiết kế bởi <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script data-goatcounter=https://henry-techie.goatcounter.com/count async src=//gc.zgo.at/count.js></script></body></html>